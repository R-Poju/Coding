RAII



在C++中，RAII（Resource Acquisition Is Initialization）是一种核心编程范式，其核心思想是：将资源的管理与对象的生命周期绑定



核心原则：

1. 资源获取即初始化。在对象的构造函数中获取资源（如内存、文件句柄、锁、网络连接等）
2. 资源释放即析构。在对象的析构函数中自动释放资源，当对象离开作用域时，其析构函数会被自动调用



关键机制：

* 构造函数：获取资源（分配内存、打开文件等）
* 析构函数：释放资源（释放内存、关闭文件等）
* 作用域规则：对象离开作用域时，析构函数必定被调用（即使发生异常）



为什么需要RAII

1. 异常安全。即使代码抛出异常，栈展开过程也会保证已构造对象的析构函数被调用
2. 避免资源泄漏。无需手动管理资源，消除忘记释放资源的风险
3. 简化代码。资源管理自动化，减少冗余代码



场景

|   场景   |     传统方式     |    RAII方式     |
| :------: | :--------------: | :-------------: |
| 内存管理 |  手动new/delete  | std::unique_ptr |
| 文件操作 | 手动fopen/fclose |   std::fsream   |
|  锁管理  | 手动lock/unlock  | std::lock_guard |
| 异常处理 |   可能泄漏资源   |  自动释放资源   |



注意事项：

1. 避免裸指针。优先使用智能指针（std::unique_ptr, std::shared_ptr）而非直接new/delete
2. 禁止拷贝需谨慎。若资源不可共享（如独占锁），应禁止拷贝构造和赋值（使用=delete）
3. 移动语义支持。对可转移的资源（如std::unique_ptr），实现移动构造函数和移动赋值运算符

























